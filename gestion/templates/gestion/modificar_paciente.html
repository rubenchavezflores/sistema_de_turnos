<form method="post">
    {% csrf_token %}

    <div class="mb-3">
        <label>DNI:</label>
        <input type="text" name="dni" class="form-control" value="{{ paciente.dni }}" readonly>
    </div>

    <div class="mb-3">
        <label>Sexo:</label>
        <select name="sexo" class="form-select" required>
            <option value="">-- Seleccionar --</option>
            <option value="M" {% if paciente.sexo == 'M' %}selected{% endif %}>Masculino</option>
            <option value="F" {% if paciente.sexo == 'F' %}selected{% endif %}>Femenino</option>
            <option value="O" {% if paciente.sexo == 'O' %}selected{% endif %}>Otro</option>
        </select>
    </div>

    <div class="mb-3">
        <label>Apellido:</label>
        <input type="text" name="apellido" class="form-control" value="{{ paciente.apellido }}" required>
    </div>

    <div class="mb-3">
        <label>Nombre:</label>
        <input type="text" name="nombre" class="form-control" value="{{ paciente.nombre }}" required>
    </div>

    <div class="mb-3">
        <label>Fecha de Nacimiento:</label>
        <input type="date" name="fecha_nacimiento" id="fecha_nacimiento" class="form-control" value="{{ paciente.fecha_nacimiento|date:'Y-m-d' }}">
    </div>

    <div class="mb-3">
        <label>Edad:</label>
        <input type="text" id="edad" class="form-control" value="{{ paciente.edad }}" readonly>
    </div>

    <div class="mb-3">
        <label>Teléfono Celular:</label>
        <input type="text" name="telefono_celular" class="form-control" value="{{ paciente.telefono_celular }}">
    </div>

    <div class="mb-3">
        <label>Teléfono Fijo:</label>
        <input type="text" name="telefono_fijo" class="form-control" value="{{ paciente.telefono_fijo }}">
    </div>

    <div class="mb-3">
        <label>Obra Social:</label>
        <input type="text" name="obra_social" class="form-control" value="{{ paciente.obra_social }}">
    </div>

    <div class="mb-3">
        <label>Domicilio:</label>
        <input type="text" name="domicilio" class="form-control" value="{{ paciente.domicilio }}">
    </div>

    <div class="mb-3">
        <label>Localidad:</label>
        <input type="text" name="localidad" class="form-control" value="{{ paciente.localidad }}">
    </div>

    <button type="submit" class="btn btn-success">Guardar</button>
</form>

<script>
document.getElementById('fecha_nacimiento').addEventListener('change', function () {
    const fecha = new Date(this.value);
    const hoy = new Date();
    let edad = hoy.getFullYear() - fecha.getFullYear();
    const m = hoy.getMonth() - fecha.getMonth();
    if (m < 0 || (m === 0 && hoy.getDate() < fecha.getDate())) {
        edad--;
    }
    document.getElementById('edad').value = edad >= 0 ? edad : '';
});
</script>
